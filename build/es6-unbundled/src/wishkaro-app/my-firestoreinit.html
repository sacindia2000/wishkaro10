<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/iron-list/iron-list.html"><link rel="import" href="../../bower_components/iron-image/iron-image.html"><link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html"><link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html"><script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script><script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-auth.js"></script><script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-firestore.js"></script><script src="my-firebaseglobal.js"></script></head><body><dom-module id="my-firestoreinit"><template><custom-style><style></style></custom-style></template><script>var db,imagecollection,lastVisible=0;class MyFirestoreinit extends Polymer.Element{static get is(){return'my-firestoreinit'}static get properties(){return{_lastVisible:{type:Object},_db:{type:Object},datacollection:{type:String},notifycollection:{type:String},containerdata:{type:Array},dataavailable:{type:Boolean,value:!1,notify:!0},dataarray:{type:Array,notify:!0},error:{type:String},testobj1:{type:Object,notify:!0,value:{requestdatacount:0,readdatacount:0}},requestdata:{type:Boolean,value:!1,observer:'_RequestForData'},responsedata:{type:Boolean,value:!1,notify:!0}}}_RequestForData(){console.log('Data to be Read '+this.testobj1.requestdatacount),this.testobj1.requestdatacount&&(this.testobj1.contentarray.length=0,this._Newdatarequest())}_Newdatarequest(){console.log('New Data is being requested'),imagecollection=null==this._lastVisible?gdatabase.collection(this.datacollection).orderBy('created-time','desc').limit(this.testobj1.requestdatacount):gdatabase.collection(this.datacollection).orderBy('created-time','desc').startAfter(this._lastVisible).limit(this.testobj1.requestdatacount),imagecollection.get().then(function(a){this._lastVisible=a.docs[a.docs.length-1],a.forEach(function(a){console.log('Time Stamp +++++ '+a.get('created-time')),this.testobj1.contentarray.push(a),debugtotal++}.bind(this)),this.testobj1.readdatacount=a.docs.length,this.responsedata=!this.responsedata,console.log('Total element length'+debugtotal)}.bind(this)).catch(function(a){console.log('Error getting documents: ',a)})}ready(){super.ready(),console.log('MY FIRESTORE IS READY'+this.notifycollection+this.datacollection),console.log('Value of new data ind'+this.dataavailable),this.dataarray=[],this.testobj1={},this.testobj1.contentarray=[],this._lastVisible=null,this._db=null,firebaseinit||(this.myfirebaseinit(),firebaseinit=1,gdatabase=firebase.firestore()),gdatabase.collection(this.datacollection).onSnapshot(function(a){console.log(' New data is available'),console.log('Current data: ',a),this.dataavailable=!this.dataavailable}.bind(this))}myfirebaseinit(){firebase.initializeApp({apiKey:'AIzaSyCA0RlvgN4ZLba2uAuCi3hgZDd0RHpmGJY',authDomain:'wishpix-5fff8.firebaseapp.com',databaseURL:'https://wishpix-5fff8.firebaseio.com',projectId:'wishpix-5fff8',storageBucket:'wishpix-5fff8.appspot.com',messagingSenderId:'281863013543'}),firebase.firestore().enablePersistence().then(function(){}).catch(function(a){'failed-precondition'!=a.code&&'unimplemented'!=a.code})}}window.customElements.define(MyFirestoreinit.is,MyFirestoreinit);</script></dom-module></body></html>